#################################
#	Copyright(C) cs2c, Inc		#
#		All rights reserved		#
#################################
#--------------
# WEB-IIS RULES
#--------------
rule level:"alert"; msg:"WEB-IIS MDAC Content-Type overflow attempt"; uricontent:"/msadcs.dll"; content:"Content-Type|3A|"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS repost.asp access"; uricontent:"/scripts/repost.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS .htr chunked Transfer-Encoding"; uricontent:".htr"; content:"Transfer-Encoding|3A|"; content:"chunked"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS .asp chunked Transfer-Encoding"; uricontent:".asp"; content:"Transfer-Encoding|3A|"; content:"chunked"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS /StoreCSVS/InstantOrder.asmx request"; uricontent:"/StoreCSVS/InstantOrder.asmx"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS users.xml access"; uricontent:"/users.xml"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS as_web.exe access"; uricontent:"/as_web.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS as_web4.exe access"; uricontent:"/as_web4.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS NewsPro administration authentication attempt"; content:"logged,true"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS pbserver access"; uricontent:"/pbserver/pbserver.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS trace.axd access"; uricontent:"/trace.axd"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS /isapi/tstisapi.dll access"; uricontent:"/isapi/tstisapi.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS mkilog.exe access"; uricontent:"/mkilog.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS ctss.idc access"; uricontent:"/ctss.idc"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS /iisadmpwd/aexp2.htr access"; uricontent:"/iisadmpwd/aexp2.htr"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS WebDAV file lock attempt"; content:"LOCK "; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS ISAPI .printer access"; uricontent:".printer"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS ISAPI .ida attempt"; uricontent:".ida?"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS ISAPI .ida access"; uricontent:".ida"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS ISAPI .idq attempt"; uricontent:".idq?"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS ISAPI .idq access"; uricontent:".idq"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS %2E-asp access"; content:"%2easp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS *.idc attempt"; uricontent:"/*.idc"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS Directory transversal attempt"; content:"..|5C|.."; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS Alternate Data streams ASP file access attempt"; uricontent:".asp|3A 3A 24|DATA"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS .bat? access"; uricontent:".bat?"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS .cnf access"; uricontent:".cnf"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS ASP contents view"; content:"%20"; content:"&CiRestriction=none"; content:"&CiHiliteType=Full"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS ASP contents view"; uricontent:".htw?CiWebHitsFile"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS CGImail.exe access"; uricontent:"/scripts/CGImail.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS MSProxy access"; uricontent:"/scripts/proxy/w3proxy.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS +.htr code fragment attempt"; uricontent:"+.htr"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS .htr access"; uricontent:".htr"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS SAM Attempt"; content:"sam._"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS achg.htr access"; uricontent:"/iisadmpwd/achg.htr"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS /scripts/iisadmin/default.htm access"; uricontent:"/scripts/iisadmin/default.htm"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS ism.dll access"; uricontent:"/scripts/iisadmin/ism.dll?http/dir"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS anot.htr access"; uricontent:"/iisadmpwd/anot"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS asp-dot attempt"; uricontent:".asp."; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS asp-srch attempt"; uricontent:"|23|filename=*.asp"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS bdir.htr access"; uricontent:"/bdir.htr"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS cmd32.exe access"; content:"cmd32.exe"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS cmd.exe access"; content:"cmd.exe"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS cmd? access"; content:".cmd?&"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS cross-site scripting attempt"; uricontent:"/Form_JScript.asp"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS cross-site scripting attempt"; uricontent:"/Form_VBScript.asp"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS del attempt"; content:"&del+/s+c|3A 5C|*.*"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS directory listing"; uricontent:"/ServerVariables_Jscript.asp"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS encoding access"; content:"%1u"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS exec-src access"; content:"|23|filename=*.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS fpcount attempt"; uricontent:"/fpcount.exe"; content:"Digits="; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS fpcount access"; uricontent:"/fpcount.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS getdrvs.exe access"; uricontent:"/scripts/tools/getdrvs.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS global.asa access"; uricontent:"/global.asa"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS idc-srch attempt"; content:"|23|filename=*.idc"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS iisadmpwd attempt"; uricontent:"/iisadmpwd/aexp"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS index server file source code attempt"; uricontent:"?CiWebHitsFile=/"; content:"&CiRestriction=none&CiHiliteType=Full"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS isc$data attempt"; uricontent:".idc|3A 3A 24|data"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS ism.dll attempt"; uricontent:" .htr"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS jet vba access"; uricontent:"/advworks/equipment/catalog_type.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS msadcs.dll access"; uricontent:"/msadcs.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS newdsn.exe access"; uricontent:"/scripts/tools/newdsn.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS perl access"; uricontent:"/scripts/perl"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS perl-browse newline attempt"; uricontent:"|0A|.pl"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS perl-browse space attempt"; uricontent:" .pl"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS scripts-browse access"; uricontent:"/scripts/ "; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS search97.vts access"; uricontent:"/search97.vts"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS showcode.asp access"; uricontent:"/showcode.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS site server config access"; uricontent:"/adsamples/config/site.csc"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS srch.htm access"; uricontent:"/samples/isapi/srch.htm"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS srchadm access"; uricontent:"/srchadm"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS uploadn.asp access"; uricontent:"/scripts/uploadn.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS view source via translate header"; content:"Translate|3A| F"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS viewcode.asp access"; uricontent:"/viewcode.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS webhits access"; uricontent:".htw"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS doctodep.btr access"; uricontent:"doctodep.btr"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS site/iisamples access"; uricontent:"/site/iisamples"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS CodeRed v2 root.exe access"; uricontent:"/root.exe"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS outlook web dos"; uricontent:"/exchange/LogonFrm.asp?"; content:"mailbox="; content:"%%%"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS /scripts/samples/ access"; uricontent:"/scripts/samples/"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS /msadc/samples/ access"; uricontent:"/msadc/samples/"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS iissamples access"; uricontent:"/iissamples/"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS iisadmin access"; uricontent:"/iisadmin"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS msdac access"; uricontent:"/msdac/"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS _mem_bin access"; uricontent:"/_mem_bin/"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS htimage.exe access"; uricontent:"/htimage.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS MS Site Server default login attempt"; uricontent:"/SiteServer/Admin/knowledge/persmbr/"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS MS Site Server admin attempt"; uricontent:"/Site Server/Admin/knowledge/persmbr/"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS postinfo.asp access"; uricontent:"/scripts/postinfo.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS /exchange/root.asp attempt"; uricontent:"/exchange/root.asp?acs=anon"; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS /exchange/root.asp access"; uricontent:"/exchange/root.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS WEBDAV exploit attempt"; content:"HTTP/1.1|0A|Content-type|3A| text/xml|0A|HOST|3A|"; content:"Accept|3A| */*|0A|Translate|3A| f|0A|Content-length|3A|5276|0A 0A|"; classtype:attempted-admin; 
rule level:"alert"; msg:"WEB-IIS WEBDAV nessus safe scan attempt"; content:"SEARCH / HTTP/1.1|0D 0A|Host|3A|"; content:"|0D 0A 0D 0A|"; classtype:attempted-admin; 
rule level:"alert"; msg:"WEB-IIS Battleaxe Forum login.asp access"; uricontent:"myaccount/login.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS nsiislog.dll access"; uricontent:"/nsiislog.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS IISProtect siteadmin.asp access"; uricontent:"/iisprotect/admin/SiteAdmin.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS IISProtect globaladmin.asp access"; uricontent:"/iisprotect/admin/GlobalAdmin.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS IISProtect access"; uricontent:"/iisprotect/admin/"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS Synchrologic Email Accelerator userid list access attempt"; uricontent:"/en/admin/aggregate.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS MS BizTalk server access"; uricontent:"/biztalkhttpreceive.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS register.asp access"; uricontent:"/register.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS UploadScript11.asp access"; uricontent:"/UploadScript11.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS DirectoryListing.asp access"; uricontent:"/DirectoryListing.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS /pcadmin/login.asp access"; uricontent:"/pcadmin/login.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS foxweb.exe access"; uricontent:"/foxweb.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS foxweb.dll access"; uricontent:"/foxweb.dll"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS VP-ASP shopsearch.asp access"; uricontent:"/shopsearch.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS VP-ASP ShopDisplayProducts.asp access"; uricontent:"/ShopDisplayProducts.asp"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS sgdynamo.exe access"; uricontent:"/sgdynamo.exe"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS NTLM ASN.1 vulnerability scan attempt"; content:"Authorization|3A| Negotiate YIQAAABiBoMAAAYrBgEFBQKgggBTMIFQoA4wDAYKKwYBBAGCNwICCqM"; classtype:attempted-dos; 
rule level:"alert"; msg:"WEB-IIS SmarterTools SmarterMail frmGetAttachment.aspx access"; uricontent:"/frmGetAttachment.aspx"; classtype:web-application-activity; 
rule level:"alert"; msg:"WEB-IIS SmarterTools SmarterMail login.aspx buffer overflow attempt"; uricontent:"/login.aspx"; content:"txtusername="; classtype:web-application-attack; 
rule level:"alert"; msg:"WEB-IIS SmarterTools SmarterMail frmCompose.asp access"; uricontent:"/frmCompose.aspx"; classtype:web-application-activity; 
